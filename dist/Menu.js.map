{
  "version": 3,
  "file": "Menu.js",
  "sourceRoot": "..",
  "sources": [
    "components/Menu.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "import {createElement,useState,useEffect,useContext,useRef,createRef} from 'react'\nh = createElement\nimport cn from 'classnames'\n# import decidePosition from './decidePosition.coffee'\nimport LayoutContext from './LayoutContext'\n\n\n\nimport {clampPosition,getPosition,fixAlign,guessAlign,clampHeight} from './Align'\n\n\nMenu = (props)->\n\tcontext = useContext(LayoutContext)\n\t\n\tif props.autoDeselect?\n\t\tautoDeselect = props.autoDeselect\n\telse if context?.autoDeselect?\n\t\tautoDeselect = context.autoDeselect\n\telse\n\t\tautoDeselect = yes\n\t\n\tself_context = Object.assign {},context,{autoDeselect:autoDeselect,root:no,vert:props.vert,depth:context?.depth+1}\n\tmenu_ref = useRef()\n\n\tuseEffect ()->\n\t\treturn ()->\n\t\t\t# log 'DECELECT'\n\t\t\tif self_context.autoDeselect\n\t\t\t\tprops.onSelect?(undefined,undefined)\n\t,[]\n\n\tif !context\n\t\treturn null\n\n\n\tlabel_keys = Object.keys(props.items)\n\tmax_label_width = 0\n\ttotal_label_width = 0\n\tselected_label_index = -1\n\tselected_label_y = 0\n\tselected_label_x = 0\n\ttotal_label_height = 0\n\tlabel_widths = label_keys.map (key,i)->\n\t\t\n\t\t\n\t\tif !props.items[key]\n\t\t\treturn 0\n\t\t\n\t\tif props.items[key].label\n\t\t\tkey = props.items[key].label\n\t\t\n\t\tif key == props.select\n\t\t\tselected_label_index = i\n\t\t\tselected_label_y = total_label_height\n\t\t\tselected_label_x = total_label_width\n\t\t\n\t\twidth = context.getLabelWidth(key)\n\t\t# log 'get label width',key,width,context.wpad*2,context.dim\n\t\tif width > max_label_width\n\t\t\tmax_label_width = width\n\t\t\n\t\ttotal_label_width += width + context.wpad*2\n\t\ttotal_label_height += context.dim\n\t\treturn width + context.wpad*2\n\t\n\t\n\tvert = props.vert\n\n\tif vert\n\t\tself_height = context.dim * label_keys.length\n\t\tself_width = max_label_width+context.wpad*2\n\telse\n\t\tself_height = context.dim\n\t\tself_width = total_label_width\n\t\n\tnew_height = clampHeight(context,self_height)\n\toverflow_y = new_height < self_height\n\tself_height = new_height\n\tscroll_top = menu_ref.current?.scrollTop || 0\n\t# style.minHeight = MIN_HEIGHT\n\t# style.height = self_height\n\t\n\n\tif props.align\n\t\talign_key = props.align\n\t\t# log 'FORCE ALIGN FOR ',context.selected_label,' : ',align_key\n\telse\n\t\tself_x = props.position?[0] || context.x || 0\n\t\tself_y = props.position?[1] || context.y || 0\n\t\t\n\n\t\talign_key = guessAlign(self_width,self_height,context,self_x,self_y)\n\t\t# log 'GUESSED ALIGN FOR ',context.selected_label,' : ',align_key\n\t\t# [x,y] = getPosition(self_width,self_height,context,align_key)\n\t\talign_key = fixAlign(align_key,context,self_width,self_height)\n\t\t# log 'FIX ALIGN FOR ',context.selected_label,' : ',align_key\n\t\n\t\n\n\tif props.position\n\t\tself_x = props.position[0]\n\t\tself_y = props.position[1]\n\t\n\telse if context.root\n\t\tself_x = context.x || 0\n\t\tself_y = context.y || 0\n\t\t\n\telse\n\t\t[self_x,self_y] = getPosition(self_width,self_height,context,align_key)\n\t\t\n\t\t[offset_x,offset_y] = clampPosition(context,self_x,self_y,self_width,self_height,align_key)\n\t\tself_x += offset_x\n\t\tself_y += offset_y\n\n\n\n\tstyle = {}\n\tstyle.overflowY = overflow_y && 'scroll'\n\tstyle.zIndex = props.select && 666 || 1\n\tstyle.zIndex += self_context.depth\n\tstyle.left = self_x+'px'\n\tstyle.top = self_y+'px'\n\tstyle.height = self_height+'px'\n\t# if offset_x || offset_y\n\t# \tstyle.transform = \"translate(#{offset_x}px,#{offset_y}px)\"\n\tif props.style\n\t\tObject.assign style,props.style\n\n\tself_context.width = self_width\n\tself_context.height = self_height\n\tself_context.x = self_x\n\tself_context.y = self_y\n\tself_context.vert = props.vert\n\tself_context.root = false\n\tself_context.align = align_key\n\tself_context.selected_label = props.select\n\tif props.vert\n\t\tself_context.sel_x = self_x\n\t\tself_context.sel_y = self_y + selected_label_y + scroll_top\n\telse\n\t\tself_context.sel_x = self_x + selected_label_x\n\t\tself_context.sel_y = self_y + scroll_top\n\t\n\tself_context.sel_w = label_widths[selected_label_index]\n\n\tselected_child = null\n\n\tif props.items\n\t\tlabels = label_keys.map (key,i)->\n\t\t\tchild = props.items[key]\n\t\t\tif !child\n\t\t\t\treturn null\n\n\n\t\t\tlabel = child.label || key\n\n\t\t\t# log context.wpad\n\t\t\tif child.onClick || child.onSelect\n\t\t\t\treturn h 'div',\n\t\t\t\t\tkey:key\n\t\t\t\t\tclassName: cn 'ed-menu-item-label',props.select == key && 'ed-selected','noselect'\n\t\t\t\t\tstyle:\n\t\t\t\t\t\tpaddingLeft: context.wpad\n\t\t\t\t\t\twidth: label_widths[i]\n\t\t\t\t\tonClick: child.onClick || child.onSelect\n\t\t\t\t\tlabel\n\n\t\t\ttitle = key+'-'+i\n\t\t\tlabel_keys.push(key)\n\n\t\t\tif props.select == key\n\t\t\t\tif (typeof child == 'function')\n\t\t\t\t\tselected_child = child()\n\t\t\t\telse if child.render\n\t\t\t\t\tselected_child = child.render()\n\t\t\t\telse if child.label\n\t\t\t\t\tselected_child = null\n\t\t\t\telse\n\t\t\t\t\tselected_child = child\n\n\t\t\treturn h 'button',\n\t\t\t\tkey:key\n\t\t\t\ttitle: title\n\t\t\t\tstyle:\n\t\t\t\t\tminWidth: label_widths[i]\n\t\t\t\t\tpaddingLeft: context.wpad\n\t\t\t\tonClick: props.onSelect && ( (e)->\n\t\t\t\t\tif e.target.title != title\n\t\t\t\t\t\treturn\n\t\t\t\t\tif props.select == key\n\t\t\t\t\t\tprops.onSelect(undefined)\n\t\t\t\t\telse\n\t\t\t\t\t\tprops.onSelect(key)\n\t\t\t\t\te.stopPropagation()\n\t\t\t\t\te.preventDefault()\n\t\t\t\t\treturn false\n\t\t\t\t) || undefined\n\t\t\t\tclassName: cn 'ed-menu-item-label',props.select == key && 'ed-selected','noselect'\n\t\t\t\tlabel\n\n\n\th 'div',\n\t\tclassName: cn 'ed-menu',props.vert && 'ed-flex-down' || 'ed-flex-right',self_context.depth % 2 == 0 && 'ed-menu-alt'\n\t\tstyle: style\n\t\tref: menu_ref\n\t\th 'div',\n\t\t\tclassName: cn 'ed-menu-labels',props.vert && 'ed-flex-down' || 'ed-flex-right'\n\t\t\tlabels\n\t\th LayoutContext.Provider,\n\t\t\tvalue: self_context\n\t\t\tselected_child\n\n\nexport default Menu"
  ]
}