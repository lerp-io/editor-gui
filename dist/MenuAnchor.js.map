{
  "version": 3,
  "file": "MenuAnchor.js",
  "sourceRoot": "..",
  "sources": [
    "components/MenuAnchor.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "import {createElement,useState,useEffect,useContext,useRef,createRef} from 'react'\nh = createElement\nimport cn from 'classnames'\n# import decidePosition from './decidePosition.coffee'\nimport LayoutContext from './LayoutContext'\nimport {clampPosition,clampHeight} from './Align'\n\n\nBAR_DIM = 12\nREBAR_DIM = 4\nAUTO_HANDLE_SET_THRESHOLD = 20\nAUTO_HANDLE_SNAP_THRESHOLD = 12\nDOT_DIM = 4\n\nMenuAnchor = (props)->\n\tanchor_ref = useRef('ed-anchor',anchor_ref)\n\tcontext = useContext(LayoutContext)\n\tcontent_ref = useRef()\n\t[dim,setDim] = useState({})\n\t[drag_start_pos,setDragStartPos] = useState(undefined)\n\t[resize_start_pos,setResizeStartPos] = useState(undefined)\n\t[set_handle_pos,setHandlePos] = useState(undefined)\n\t[is_dragging,setDragging] = useState(false)\n\t[z_index,setZIndex] = useState(0)\n\tupdateZIndex = (z_index)->\n\t\tsetZIndex(z_index)\n\t\n\t# log 'render'\n\t\n\tcheckAnchorDim = ()->\n\t\tif content_ref.current\n\t\t\trect = content_ref.current.children[0].getBoundingClientRect()\n\t\t\t# log 'on_update',rect\n\t\t\tif dim.width != rect.width || dim.height != rect.height\n\t\t\t\t# log 'SET DIM',rect\n\t\t\t\tsetDim({\n\t\t\t\t\twidth: rect.width\n\t\t\t\t\theight: rect.height\n\t\t\t\t})\n\t# log dim\n\tuseEffect ()->\n\t\tcheckAnchorDim()\n\t\treturn\n\n\tif !context\n\t\treturn null\n\t\n\t# log dim\n\t\n\tif dim.width && dim.height\n\t\td_left = Math.max(0,props.position[0])\n\t\td_top = Math.max(0,props.position[1])\n\t\td_bottom = Math.max(0,context.view_rect.height - (props.position[1] + dim.height + BAR_DIM))\n\t\td_right = Math.max(0,context.view_rect.width - (props.position[0] + dim.width + BAR_DIM))\n\n\t\t# if (props.position[1] + dim.height + BAR_DIM)\n\n\t# log d_left,d_top,d_bottom,d_right\n\t# log d_top,d_bottom\n\tsnap_bot = false\n\n\tif d_left <= Math.min(d_right,Math.min(d_top,d_bottom)) && d_left < AUTO_HANDLE_SET_THRESHOLD\n\t\thandle_pos = 'left'\n\t\tif props.autoSnapHandlePosition\n\t\t\t# setTimeout ()->\n\t\t\tprops.position[0] = 0\n\t\t\t# ,0\n\telse if d_top <= Math.min(d_bottom,Math.min(d_left,d_right)) && d_top < AUTO_HANDLE_SET_THRESHOLD\n\t\thandle_pos = 'top'\n\t\tif props.autoSnapHandlePosition\n\t\t\t# setTimeout ()->\n\t\t\tprops.position[1] = 0\n\telse if d_right <= Math.min(d_left,Math.min(d_top,d_bottom)) && d_right < AUTO_HANDLE_SET_THRESHOLD\n\t\thandle_pos = 'right'\n\t\tif props.autoSnapHandlePosition\n\t\t\tprops.position[0] = Math.max(0,context.view_rect.width - dim.width - BAR_DIM)\n\telse if d_bottom <= Math.min(d_top,Math.min(d_left,d_right)) && d_bottom < AUTO_HANDLE_SET_THRESHOLD\n\t\thandle_pos = 'bottom'\n\t\tif props.autoSnapHandlePosition\n\t\t\tsnap_bot = true\n\t\t\tprops.position[1] = Math.max(0,context.view_rect.height - dim.height - BAR_DIM)\n\telse\n\t\thandle_pos = 'top'\n\t\n\tif props.autoHandlePosition && handle_pos != set_handle_pos\n\t\tsetHandlePos(handle_pos)\n\t\n\tif !props.autoHandlePosition\n\t\thandle_pos = props.handlePosition || 'left'\n\t\n\t# log handle_pos\n\n\tdot_width = DOT_DIM\n\tdot_height = DOT_DIM\n\n\t[offset_x,offset_y] = clampPosition(self_context,self_x,self_y,self_width,self_height,undefined)\n\tself_x += offset_x\n\tself_y += offset_y\n\n\n\tif dim.width && dim.height\n\t\tswitch handle_pos\n\t\t\twhen 'left'\n\t\t\t\tbar_width = BAR_DIM\n\t\t\t\tbar_height = dim.height\n\t\t\t\tbar_left = props.position[0]\n\t\t\t\tbar_top = props.position[1]\n\t\t\t\t\n\t\t\t\trebar_left = props.position[0]+dim.width\n\t\t\t\trebar_top = props.position[1]\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tself_width = dim.width+BAR_DIM\n\t\t\t\tself_height = dim.height\n\t\t\t\tcontent_x = props.position[0]+BAR_DIM\n\t\t\t\tcontent_y = props.position[1]\n\t\t\t\tif !props.visible\n\t\t\t\t\tdot_height = DOT_DIM*3\n\t\t\t\t\n\t\t\twhen 'right'\n\t\t\t\tbar_width = BAR_DIM\n\t\t\t\tbar_height = dim.height\n\t\t\t\tbar_left = props.position[0]+dim.width\n\t\t\t\tbar_top = props.position[1]\n\t\t\t\t\n\t\t\t\trebar_left = props.position[0]-REBAR_DIM\n\t\t\t\trebar_top = props.position[1]\n\t\t\t\t\n\t\t\t\tself_width = dim.width+BAR_DIM\n\t\t\t\tself_height = dim.height\n\t\t\t\tcontent_x = props.position[0]\n\t\t\t\tcontent_y = props.position[1]\n\t\t\t\tif !props.visible\n\t\t\t\t\tdot_height = DOT_DIM*3\n\t\t\t\t\n\n\t\t\twhen 'top'\n\t\t\t\tbar_width = dim.width\n\t\t\t\tbar_height = BAR_DIM\n\t\t\t\tbar_left = props.position[0]\n\t\t\t\tbar_top = props.position[1]\n\n\t\t\t\trebar_left = props.position[0]\n\t\t\t\trebar_top = props.position[1]+dim.height+BAR_DIM\n\t\t\t\t\n\t\t\t\tself_height = dim.height+BAR_DIM\n\t\t\t\tself_width = dim.width\n\t\t\t\tcontent_x = props.position[0]\n\t\t\t\tcontent_y = props.position[1]+BAR_DIM\n\t\t\t\tif !props.visible\n\t\t\t\t\tdot_width = DOT_DIM * 3\n\t\t\t\t\n\t\t\t\n\t\t\twhen 'bottom'\n\t\t\t\tbar_width = dim.width\n\t\t\t\tbar_height = BAR_DIM\n\t\t\t\tbar_left = props.position[0]\n\t\t\t\tbar_top = props.position[1]+dim.height\n\n\t\t\t\trebar_left = props.position[0]\n\t\t\t\trebar_top = props.position[1]-REBAR_DIM\n\n\t\t\t\tself_width = dim.width\n\t\t\t\tself_height = dim.height+BAR_DIM\n\t\t\t\tcontent_x = props.position[0]\n\t\t\t\tcontent_y = props.position[1]\n\n\t\t\t\tif !props.visible\n\t\t\t\t\tdot_width = DOT_DIM * 3\n\n\t\n\t\t# if props.handlePosition == 'right'\n\t\t\t\n\t\n\t# log props.position\n\t# log props.size\n\n\tself_context = Object.assign {},context,\n\t\talign: props.align || 'right-down'\n\t\tclamp_width: props.size?[0] || 0\n\t\tclamp_height: props.size?[1] || 0\n\t\t\n\t\tx: content_x\n\t\ty: content_y\n\t\troot: yes\n\t\tcheckAnchorDim: checkAnchorDim\n\n\n\t# log self_context.view_rect\n\n\t\n\tif props.visible || (!dim.width? || !dim.height?)\n\t\tcontent = h 'div',\n\t\t\tcn: 'ed-anchor-content'\n\t\t\tref: content_ref\n\t\t\t# style:\n\t\t\t# \tpointerEvents: drag_start_pos && 'none' || undefined\n\t\t\th LayoutContext.Provider,\n\t\t\t\tvalue: self_context\n\t\t\t\tprops.children\n\n\tif props.size && props.visible\n\t\tresize_bar = h 'div',\n\t\t\tstyle:\n\t\t\t\tbackground: props.barColor || 'black'\n\t\t\t\ttop: rebar_top\n\t\t\t\tleft: rebar_left\n\t\t\t\theight:  (handle_pos == 'left' || handle_pos == 'right') && bar_height || REBAR_DIM\n\t\t\t\twidth:  (handle_pos == 'left' || handle_pos == 'right') && REBAR_DIM || bar_width\n\t\t\t\tflexDirection: (handle_pos == 'left' || handle_pos == 'right') && 'column' || 'row'\n\t\t\tcn: 'ed-anchor-handle-resize'\n\t\t\t\n\t\t\tonMouseDown: (e)->\n\t\t\t\tsetResizeStartPos([e.clientX,e.clientY,props.size[0],props.size[1]])\n\t\t\t\te.preventDefault()\n\t\t\t\te.stopPropagation()\n\t\t\t\treturn false\n\n\n\th 'div',\n\t\tstyle:\n\t\t\ttop: 0\n\t\t\tleft: 0\n\t\t\tzIndex: z_index\n\t\t\twidth: (resize_start_pos|| drag_start_pos) && '100vw' || undefined\n\t\t\theight: (resize_start_pos || drag_start_pos) && '100vh' || undefined\n\t\tcn: cn('ed-anchor',drag_start_pos && 'ed-anchor-drag',resize_start_pos && 'ed-anchor-resize')\n\t\tref: anchor_ref\n\t\tonMouseMove: (e)->\n\t\t\t\n\t\t\tif resize_start_pos\n\t\t\t\t# log resize_start_pos\n\t\t\t\tif !is_dragging\n\t\t\t\t\tsetDragging(true)\n\t\t\t\t# self_width = resize_start_pos[2]+e.clientX-resize_start_pos[0]\n\t\t\t\t\n\t\t\t\tif snap_bot\n\t\t\t\t\tself_height = Math.max(0,resize_start_pos[3]-e.clientY+resize_start_pos[1])\n\t\t\t\t\t\n\t\t\t\telse\n\t\t\t\t\tself_height = Math.max(0,resize_start_pos[3]+e.clientY-resize_start_pos[1])\n\t\t\t\t\t\n\t\t\t\t# max_height = maxHeight(context,self_height)\n\t\t\t\tset_height = clampHeight(context,self_height)\n\t\t\t\t\n\t\t\t\t# if set_height - max_height\n\n\t\t\t\t# if self_height != set_height\n\t\t\t\tprops.setSize(0,set_height)\n\n\t\t\t\te.stopPropagation()\n\t\t\t\te.preventDefault()\n\t\t\t\treturn false\n\n\t\t\telse if drag_start_pos\n\t\t\t\tif !is_dragging\n\t\t\t\t\tsetDragging(true)\n\t\t\t\tself_x = drag_start_pos[2]+e.clientX-drag_start_pos[0]\n\t\t\t\tself_y = drag_start_pos[3]+e.clientY-drag_start_pos[1]\n\t\t\t\t\n\n\t\t\t\tprops.setPosition(self_x,self_y)\n\t\t\t\tif !props.visible\n\t\t\t\t\tprops.onBarClick()\n\t\t\t\te.stopPropagation()\n\t\t\t\te.preventDefault()\n\t\t\t\treturn false\n\n\t\t\t\n\n\t\tonMouseUp: (e)->\n\t\t\tif drag_start_pos != undefined\n\t\t\t\tsetDragStartPos(undefined)\n\t\t\t\tsetDragging(false)\n\t\t\t\tif !is_dragging\n\t\t\t\t\tprops.onBarClick()\n\t\t\t\t\n\t\t\t\te.stopPropagation()\n\t\t\t\te.preventDefault()\n\t\t\t\treturn false\n\t\t\t\n\t\t\telse if resize_start_pos != undefined\n\t\t\t\tsetResizeStartPos(undefined)\n\t\t\t\tsetDragging(false)\n\t\t\t\tif !is_dragging\n\t\t\t\t\tprops.onBarClick()\n\t\t\t\t\n\t\t\t\te.stopPropagation()\n\t\t\t\te.preventDefault()\n\t\t\t\treturn false\n\t\t\t\n\t\t\t\n\n\t\tonMouseEnter: ()->\n\t\t\t# log 'mouse enter'\n\t\t\tsetZIndex(999)\n\t\t\n\t\tonMouseLeave: ()->\n\t\t\tsetZIndex(0)\n\t\t\t# log 'mouse leave'\n\t\t\tif drag_start_pos != undefined\n\t\t\t\tsetDragStartPos(undefined)\n\t\t\t\tsetDragging(false)\n\t\t\tif resize_start_pos != undefined\n\t\t\t\tsetResizeStartPos(undefined)\n\t\t\t\tsetDragging(false)\n\t\t\t\t\n\t\t\n\n\n\n\t\th 'div',\n\t\t\tcn: 'ed-anchor-handle'\n\t\t\tstyle:\n\t\t\t\ttop: bar_top\n\t\t\t\tleft: bar_left\n\t\t\t\theight: bar_height\n\t\t\t\twidth: bar_width\n\t\t\t\tflexDirection: (handle_pos == 'left' || handle_pos == 'right') && 'column' || 'row'\n\t\t\t\tbackground: props.barColor || 'black'\n\t\t\t\t\n\t\t\tonMouseDown: (e)->\n\t\t\t\tsetDragStartPos([e.clientX,e.clientY,props.position[0],props.position[1]])\n\t\t\t\te.stopPropagation()\n\t\t\t\te.preventDefault()\n\t\t\t\treturn false\n\t\t\tfor i in [0...props.dotCount || 1]\n\t\t\t\th 'div',\n\t\t\t\t\tcn: 'ed-anchor-dot'\n\t\t\t\t\tkey: i\n\t\t\t\t\tstyle:\n\t\t\t\t\t\tbackground: props.dotColor || 'white'\n\t\t\t\t\t\twidth: dot_width\n\t\t\t\t\t\theight: dot_height\n\n\t\tresize_bar\n\n\t\t\t\n\t\t\t\n\t\tcontent\n\n\t\t\n\t\t\t\t\n\nexport default MenuAnchor"
  ]
}